prefix="."
dbconn="dbname='linuxbugs' host='localhost' port='5432'"
projects="/home/npalix/Documents/build/herodotos-cvs/demo"
website="./website"
cpucore = 1

project Linux {
  dir = linux

  versions = {
  ("linux-2.6.0",  12/18/2003, 3626873)
  ("linux-2.6.1",  01/09/2004, 3607545)
  ("linux-2.6.2",  02/04/2004, 3670554)
  ("linux-2.6.3",  02/18/2004, 3713312)
  ("linux-2.6.4",  03/11/2004, 3744413)
  ("linux-2.6.5",  04/04/2004, 3773257)
  ("linux-2.6.6",  05/10/2004, 3816743)
  ("linux-2.6.7",  06/16/2004, 3825070)
  ("linux-2.6.8",  08/14/2004, 3881767)
  ("linux-2.6.9",  10/19/2004, 3951026)
  ("linux-2.6.10", 12/24/2004, 3979326)
  ("linux-2.6.11", 03/02/2005, 4051267)
  ("linux-2.6.12", 06/17/2005, 4155826)
  ("linux-2.6.13", 08/28/2005, 4289406)
  ("linux-2.6.14", 10/27/2005, 4399620)
  ("linux-2.6.15", 01/02/2006, 4481795)
  ("linux-2.6.16", 03/19/2006, 4601957)
  ("linux-2.6.17", 06/17/2006, 4669412)
  ("linux-2.6.18", 09/19/2006, 4750426)
  ("linux-2.6.19", 11/29/2006, 4890004)
  ("linux-2.6.20", 02/04/2007, 4972172)
  ("linux-2.6.21", 04/25/2007, 5060948)
  ("linux-2.6.22", 07/08/2007, 5215458)
  ("linux-2.6.23", 10/09/2007, 5272632)
  ("linux-2.6.24", 01/24/2008, 5455345)
  ("linux-2.6.25", 04/16/2008, 5679912)
  ("linux-2.6.26", 07/13/2008, 5780304)
  ("linux-2.6.27", 10/09/2008, 5903948)
  ("linux-2.6.28", 12/24/2008, 6219333)
  ("linux-2.6.29", 03/23/2009, 6724330)
  ("linux-2.6.30", 06/09/2009, 7083842)
  ("linux-2.6.31", 09/09/2009, 7338314)
  ("linux-2.6.32", 12/02/2009, 7663555)
  ("linux-2.6.33", 02/24/2010, 7889875)
//  ("linux-2.6.34", 05/16/2010, 8103841)
 }
}

#include "subdir.s2j"

pattern Block {
 color = 0 1 0
}
pattern Null {
 color = 0 .5 0
}
pattern Var {
 color = 0 1 .5
}
pattern INull {
 color = 1 0 0
}
pattern Range {
 color = 0 0 0
}
pattern Lock {
 color = .5 0 1
}
pattern Intr {
 color = 0 .5 1
}
pattern LockIntr {
 color = .5 .5 1
}
pattern Free {
 color = .5 0 0
}
pattern Float {
 color = 0 1 1
}
pattern Real {
 color = 0 0 .5
}
pattern Param {
 color = 0 0 1
}
pattern Size {
 color = .5 0 .5
}

#define COUNT_CURVE(patt, patt2)                       \
 curve pattern patt {				       \
   sql = SELECT version_name, release_date, sum(data) as data       \
       	 	FROM "Count evol"                      \
       	 	WHERE standardized_name = patt2        \
		AND release_date > '2002-01-01'        \
		GROUP BY version_name, release_date;   \
 }

graph gr/count-evol.jgr {
 xaxis = date
 yaxis = user
 project = Linux
 size = 3 2

 COUNT_CURVE(Block, 'Block')
// COUNT_CURVE(Null , 'Null' )
 COUNT_CURVE(Var  , 'Var'  )
 COUNT_CURVE(INull, 'INull')
 COUNT_CURVE(Range, 'Range')
 COUNT_CURVE(Lock , 'Lock' )
 COUNT_CURVE(Intr , 'Intr' )
 COUNT_CURVE(LockIntr , 'LockIntr' )
 COUNT_CURVE(Free , 'Free' )
 COUNT_CURVE(Float, 'Float')
 COUNT_CURVE(Real , 'Real' )
 COUNT_CURVE(Param, 'Param')
 COUNT_CURVE(Size , 'Size' )
}

#define ORIG_CURVE(patt, patt2)                        \
 curve pattern patt {				       \
   sql = SELECT version_name, release_date, number_of_bugs_already_present       \
       	 	FROM "Origin of bugs"                  \
       	 	WHERE standardized_name = patt2        \
		AND for_version_name='linux-2.6.33'    \
		ORDER BY release_date;                 \
 }

graph gr/orig-2_6_33.jgr {
 xaxis = date
 yaxis = user
 project = Linux
 size = 1.5 1

 ORIG_CURVE(Block, 'Block')
// ORIG_CURVE(Null , 'Null' )
 ORIG_CURVE(Var  , 'Var'  )
 ORIG_CURVE(INull, 'INull')
 ORIG_CURVE(Range, 'Range')
 ORIG_CURVE(Lock , 'Lock' )
 ORIG_CURVE(Intr , 'Intr' )
 ORIG_CURVE(LockIntr , 'LockIntr' )
 ORIG_CURVE(Free , 'Free' )
 ORIG_CURVE(Float, 'Float')
 ORIG_CURVE(Real , 'Real' )
 ORIG_CURVE(Param, 'Param')
 ORIG_CURVE(Size , 'Size' )
}

/*
graph gr/count.jgr {
 xaxis = groups
 legend = "off"
 size = 3 1
 sql = SELECT standardized_name, data FROM "Bugs per OSDI category" \
       WHERE version_name='linux-2.6.33';
}
*/

#define DIR_CURVE(ver, patt, patt2, dir) \
  curve pattern patt {              \
   sql = SELECT standardized_name, "Number of errors" FROM "Per dir and cat" \
         WHERE standardized_name = patt2 AND dirname = dir          \
	       AND version_name = ver; \
  }

#define DIR_GRP(ver, dir, dir2)   \
 group dir {          		  \
  DIR_CURVE(ver, Block, 'Block', dir2) \
  DIR_CURVE(ver, Null , 'Null' , dir2) \
  DIR_CURVE(ver, Var  , 'Var'  , dir2) \
  DIR_CURVE(ver, INull, 'INull', dir2) \
  DIR_CURVE(ver, Range, 'Range', dir2) \
  DIR_CURVE(ver, Lock , 'Lock' , dir2) \
  DIR_CURVE(ver, Intr , 'Intr' , dir2) \
  DIR_CURVE(ver, LockIntr , 'LockIntr' , dir2) \
  DIR_CURVE(ver, Free , 'Free' , dir2) \
  DIR_CURVE(ver, Float, 'Float', dir2) \
  DIR_CURVE(ver, Real , 'Real' , dir2) \
  DIR_CURVE(ver, Size , 'Size' , dir2) \
 }
//  DIR_CURVE(ver, Param, 'Param', dir2) \

graph gr/count-per-dir-4-241.jgr {
 xaxis = groups
 size = 3 1
 legend = "defaults x 63 y 45 fontsize 8"

 DIR_GRP('linux-2.4.1', "Drivers", 'drivers')
 DIR_GRP('linux-2.4.1', "Arch"   , 'arch')
 DIR_GRP('linux-2.4.1', "FS"     , 'fs')
 DIR_GRP('linux-2.4.1', "Net"    , 'net')
 DIR_GRP('linux-2.4.1', "Other"  , 'other')
}

graph gr/count-per-dir-4-260.jgr {
 xaxis = groups
 size = 3 1
 legend = "off"

 DIR_GRP('linux-2.6.0', "Drivers", 'drivers')
 DIR_GRP('linux-2.6.0', "Sound"  , 'sound')
 DIR_GRP('linux-2.6.0', "Arch"   , 'arch')
 DIR_GRP('linux-2.6.0', "FS"     , 'fs')
 DIR_GRP('linux-2.6.0', "Net"    , 'net')
 DIR_GRP('linux-2.6.0', "Other"  , 'other')
}

graph gr/count-per-dir-4-2612.jgr {
 xaxis = groups
 size = 3 1
 legend = "off"

 DIR_GRP('linux-2.6.12', "Drivers", 'drivers')
 DIR_GRP('linux-2.6.12', "Sound"  , 'sound')
 DIR_GRP('linux-2.6.12', "Arch"   , 'arch')
 DIR_GRP('linux-2.6.12', "FS"     , 'fs')
 DIR_GRP('linux-2.6.12', "Net"    , 'net')
 DIR_GRP('linux-2.6.12', "Other"  , 'other')
}

graph gr/count-per-dir-4-2633.jgr {
 xaxis = groups
 size = 3 1
 legend = "off"

 DIR_GRP('linux-2.6.33', "Drivers", 'drivers')
 DIR_GRP('linux-2.6.33', "Staging", 'staging')
 DIR_GRP('linux-2.6.33', "Sound"  , 'sound')
 DIR_GRP('linux-2.6.33', "Arch"   , 'arch')
 DIR_GRP('linux-2.6.33', "FS"     , 'fs')
 DIR_GRP('linux-2.6.33', "Net"    , 'net')
 DIR_GRP('linux-2.6.33', "Other"  , 'other')
}

graph gr/avg-ages.jgr {
 xaxis = groups
 legend = "off"
 factor = 365.25
 ylegend = "Years"
 size = 3 1
 sql = SELECT * FROM "Avg age";
}
