#define RATEx86_YMAX ymax = 0.04

pattern FALSE  { color = 1 0   0 }
pattern TRUE   { color = 0 1   0 }
pattern ALLYES { color = 1 .69 0 }

#define RATE_DEF_CURVE(ver, curve_name, patt2, def) \
  curve pattern def {                               \
   legend = curve_name                              \
   sql = SELECT standardized_name, rate FROM osdi_rate_by_error_name_4_x386 \
         WHERE standardized_name = patt2            \
	       AND version_name = ver               \
	       AND def_compiled = def;              \
  }

#define RATE_DEF_GRP(ver, patt, patt2)         \
 group patt {          		               \
  RATE_DEF_CURVE(ver, "Default", patt2, TRUE ) \
  RATE_DEF_CURVE(ver, "Non dft", patt2, FALSE) \
 }

#define RATE_ALL_GRP(ver, patt, patt2)         \
 group patt {          		               \
  curve pattern TRUE {                         \
   legend = "Default"                          \
   sql = SELECT standardized_name, rate FROM osdi_rate_by_error_name_4_x386 \
         WHERE standardized_name = patt2       \
	       AND version_name = ver          \
	       AND def_compiled = TRUE;        \
  }                                            \
  curve pattern ALLYES {                       \
   legend = "All yes"                          \
   sql = SELECT standardized_name, rate FROM osdi_rate_by_error_name_4_x386_allyes \
         WHERE standardized_name = patt2       \
	       AND version_name = ver          \
	       AND allyes_compiled = TRUE;     \
  }                                            \
  curve pattern FALSE                          \
   legend = "Other"                            \
   sql = SELECT standardized_name, rate FROM osdi_rate_by_error_name_4_x386 \
         WHERE standardized_name = patt2       \
	       AND version_name = ver          \
	       AND def_compiled = FALSE;       \
	       AND allyes_compiled = FALSE;    \
  }                                            \
 }

graph gr/rate-4-241-x86.jgr {
 xaxis = groups
 size = 3 1
 //"defaults x 63 y 45 fontsize 8"
 legend = "off"
 RATEx86_YMAX

  RATE_DEF_GRP('linux-2.4.1', "Block"    , 'Block'    ) \
  RATE_DEF_GRP('linux-2.4.1', "Null"     , 'Null'     ) \
  RATE_DEF_GRP('linux-2.4.1', "Var"      , 'Var'      ) \
  RATE_DEF_GRP('linux-2.4.1', "Lock"     , 'Lock'     ) \
  RATE_DEF_GRP('linux-2.4.1', "Intr"     , 'Intr'     ) \
  RATE_DEF_GRP('linux-2.4.1', "LockIntr" , 'LockIntr' ) \
  RATE_DEF_GRP('linux-2.4.1', "Free"     , 'Free'     ) \
  RATE_DEF_GRP('linux-2.4.1', "Size"     , 'Size'     )

}

graph gr/rate-4-2633-x86.jgr {
 xaxis = groups
 size = 3 1
 RATEx86_YMAX
 legend = "off

newstring fontsize 6 x 16 y 0.035 hjl vjb : Part of defconfig (1 685 files)
newcurve marktype box linetype none color 0. 1. 0.  marksize 0.6
pts 15 0.0355

newstring fontsize 6 x 16 y 0.025 hjl vjb : Part of allyesconfig (6 826 files)
newcurve marktype box linetype none color 1. 0.69 0.  marksize 0.6
pts 15 0.0255

newstring fontsize 6 x 16 y 0.015 hjl vjb : Part of remaining code (18 807 files)
newcurve marktype box linetype none color 1. 0. 0.  marksize 0.6
pts 15 0.0155

"

  RATE_ALL_GRP('linux-2.6.33', "Block"    , 'Block'    ) \
  RATE_ALL_GRP('linux-2.6.33', "Null"     , 'Null'     ) \
  RATE_ALL_GRP('linux-2.6.33', "Var"      , 'Var'      ) \
  RATE_ALL_GRP('linux-2.6.33', "Lock"     , 'Lock'     ) \
  RATE_ALL_GRP('linux-2.6.33', "Intr"     , 'Intr'     ) \
  RATE_ALL_GRP('linux-2.6.33', "LockIntr" , 'LockIntr' ) \
  RATE_ALL_GRP('linux-2.6.33', "Free"     , 'Free'     ) \
  RATE_ALL_GRP('linux-2.6.33', "Size"     , 'Size'     )

}
